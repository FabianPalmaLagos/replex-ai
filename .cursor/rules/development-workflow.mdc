---
description:
globs:
alwaysApply: false
---
# Development Workflow - Replex AI

## ğŸ”„ Flujo de Trabajo de Desarrollo

### Principios Fundamentales
1. **Desarrollo incremental** - PequeÃ±os commits frecuentes
2. **Testing continuo** - Tests antes de merge
3. **Code review obligatorio** - Al menos una revisiÃ³n por PR
4. **DocumentaciÃ³n actualizada** - Solo cuando sea necesaria
5. **Simplicidad sobre complejidad** - Soluciones directas y mantenibles

## ğŸŒ¿ Git Workflow

### Estructura de Branches
```
main                    # ProducciÃ³n estable
â”œâ”€â”€ develop            # IntegraciÃ³n de features
â”œâ”€â”€ feature/auth       # Nueva funcionalidad
â”œâ”€â”€ feature/ai-gen     # GeneraciÃ³n IA
â”œâ”€â”€ hotfix/bug-fix     # Correcciones urgentes
â””â”€â”€ release/v1.0.0     # PreparaciÃ³n de release
```

### Convenciones de Commits
```bash
# Formato: tipo(scope): descripciÃ³n

# Tipos permitidos:
feat(auth): agregar sistema de login con JWT
fix(api): corregir validaciÃ³n de email en registro
docs(readme): actualizar instrucciones de instalaciÃ³n
style(frontend): aplicar formato con Prettier
refactor(services): simplificar lÃ³gica de generaciÃ³n IA
test(auth): agregar tests para middleware de autenticaciÃ³n
chore(deps): actualizar dependencias de seguridad

# Ejemplos especÃ­ficos del proyecto:
feat(series): implementar CRUD de series de videos
fix(generation): corregir timeout en generaciÃ³n de contenido
refactor(components): simplificar componente Dashboard
test(api): agregar tests de integraciÃ³n para usuarios
```

### Pull Request Template
```markdown
## ğŸ“‹ DescripciÃ³n
Breve descripciÃ³n de los cambios realizados.

## ğŸ¯ Tipo de Cambio
- [ ] Bug fix (cambio que corrige un issue)
- [ ] Nueva feature (cambio que agrega funcionalidad)
- [ ] Breaking change (cambio que rompe compatibilidad)
- [ ] Refactoring (cambio que mejora cÃ³digo sin cambiar funcionalidad)

## âœ… Checklist
- [ ] El cÃ³digo sigue las convenciones del proyecto
- [ ] Se han agregado tests para los cambios
- [ ] Todos los tests pasan
- [ ] Se ha actualizado la documentaciÃ³n (si es necesario)
- [ ] Los cambios han sido probados localmente

## ğŸ§ª Testing
Describe cÃ³mo se han probado los cambios.

## ğŸ“¸ Screenshots (si aplica)
Capturas de pantalla de cambios visuales.
```

## ğŸ³ Docker Workflow

### Servicios de Desarrollo
Referencia: [docker-compose.yml](mdc:docker-compose.yml)

### Comandos Docker Frecuentes
```bash
# Iniciar servicios de desarrollo
npm run docker:up

# Ver logs de servicios
npm run docker:logs

# Detener servicios
npm run docker:down

# Rebuild de servicios
docker compose up --build

# Acceso a base de datos
docker exec -it replex-postgres psql -U replex_user -d replex_ai

# Acceso a Redis
docker exec -it replex-redis redis-cli
```

### Variables de Entorno
Referencia: [env.example](mdc:env.example)

```bash
# Copiar archivo de ejemplo
cp env.example .env

# Editar variables segÃºn entorno
# Desarrollo: usar valores por defecto
# ProducciÃ³n: usar valores seguros
```

## ğŸ§ª Testing Strategy

### Niveles de Testing
1. **Unit Tests** - Funciones y componentes individuales
2. **Integration Tests** - InteracciÃ³n entre mÃ³dulos
3. **E2E Tests** - Flujos completos de usuario
4. **API Tests** - Endpoints y contratos de API

### Estructura de Tests
```
tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ components/     # Tests de componentes React
â”‚   â”œâ”€â”€ services/       # Tests de servicios backend
â”‚   â””â”€â”€ utils/          # Tests de utilidades
â”œâ”€â”€ integration/
â”‚   â”œâ”€â”€ api/           # Tests de API endpoints
â”‚   â””â”€â”€ database/      # Tests de base de datos
â””â”€â”€ e2e/
    â”œâ”€â”€ auth/          # Flujos de autenticaciÃ³n
    â”œâ”€â”€ series/        # GestiÃ³n de series
    â””â”€â”€ generation/    # GeneraciÃ³n de contenido
```

### Comandos de Testing
```bash
# Ejecutar todos los tests
npm test

# Tests con coverage
npm run test:coverage

# Tests en modo watch
npm run test:watch

# Tests especÃ­ficos
npm test -- --grep "auth"

# E2E tests
npm run test:e2e
```

## ğŸš€ Deployment Workflow

### Ambientes
1. **Development** - Local con Docker
2. **Staging** - Ambiente de pruebas
3. **Production** - Ambiente productivo

### CI/CD Pipeline (Planificado)
```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18.20.0'
      - run: npm ci
      - run: npm run lint
      - run: npm run test
      - run: npm run build

  deploy-staging:
    needs: test
    if: github.ref == 'refs/heads/develop'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Staging
        run: echo "Deploy to staging"

  deploy-production:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Production
        run: echo "Deploy to production"
```

## ğŸ“¦ Package Management

### Workspaces Configuration
Referencia: [package.json](mdc:package.json)

### Comandos de Workspaces
```bash
# Instalar dependencias en todos los workspaces
npm install

# Instalar dependencia en workspace especÃ­fico
npm install express --workspace=apps/backend

# Ejecutar script en workspace especÃ­fico
npm run dev --workspace=apps/frontend

# Ejecutar script en todos los workspaces
npm run lint --workspaces

# Agregar dependencia compartida
npm install typescript --workspace=packages/types
```

### GestiÃ³n de Dependencias
```bash
# Verificar dependencias desactualizadas
npm outdated --workspaces

# Actualizar dependencias
npm update --workspaces

# AuditorÃ­a de seguridad
npm audit --workspaces

# Corregir vulnerabilidades
npm audit fix --workspaces
```

## ğŸ”§ Development Tools

### Scripts Disponibles
Referencia: [package.json](mdc:package.json)

```bash
# Desarrollo
npm run dev              # Frontend + Backend en paralelo âœ…
npm run dev:frontend     # Solo frontend (puerto 5173) âœ…
npm run dev:backend      # Solo backend (puerto 3000) âœ…

# Build y Deploy
npm run build            # Build de todos los workspaces
npm run format           # Formatear cÃ³digo con Prettier
npm run lint             # Linting con ESLint

# Docker
npm run docker:up        # Levantar servicios
npm run docker:down      # Detener servicios
npm run docker:logs      # Ver logs

# Utilidades
npm run setup            # Setup inicial del proyecto
npm run verify           # Verificar configuraciÃ³n
```

### ConfiguraciÃ³n de Herramientas

#### ESLint
Referencia: [.eslintrc.js](mdc:.eslintrc.js)

#### Prettier
Referencia: [.prettierrc](mdc:.prettierrc)

#### TypeScript
Referencia: [tsconfig.json](mdc:tsconfig.json)

## ğŸ› Debugging

### Frontend Debugging
```bash
# Vite dev server con source maps
npm run dev:frontend

# React DevTools en navegador
# Redux DevTools (si se usa)
# Vite plugin para debugging
```

### Backend Debugging
```bash
# Node.js con inspector
node --inspect src/index.js

# VS Code debugging configuration
# Docker debugging con volumes
# Database debugging con Adminer (http://localhost:8080)
```

### Database Debugging
```bash
# Acceso directo a PostgreSQL
docker exec -it replex-postgres psql -U replex_user -d replex_ai

# Adminer web interface
http://localhost:8080

# Redis debugging
docker exec -it replex-redis redis-cli
```

## ğŸ“Š Monitoring y Logging

### Development Monitoring âœ… **IMPLEMENTADO**
```bash
# Logs de aplicaciÃ³n backend âœ…
tail -f apps/backend/logs/combined.log
tail -f apps/backend/logs/error.log

# Logs de Docker âœ…
docker compose logs -f

# Monitoring de performance
npm run dev -- --profile
```

### Error Tracking
- **Winston** para logging estructurado âœ… **IMPLEMENTADO**
- **Sentry** para error tracking (futuro)
- **Prometheus** para mÃ©tricas (futuro)
- **Grafana** para visualizaciÃ³n (futuro)

## ğŸ”’ Security Workflow

### Security Checklist
- [x] Variables de entorno no committeadas âœ…
- [x] Dependencias actualizadas y sin vulnerabilidades âœ…
- [ ] Secrets rotados regularmente
- [ ] HTTPS en producciÃ³n
- [x] Rate limiting implementado âœ…
- [x] Input validation en todas las rutas âœ…

### Security Commands
```bash
# AuditorÃ­a de dependencias
npm audit

# Verificar secrets en cÃ³digo
git secrets --scan

# AnÃ¡lisis estÃ¡tico de seguridad
npm run security:scan
```

## ğŸ“ˆ Performance Optimization

### Frontend Performance
- Bundle analysis con Vite
- Lazy loading de componentes
- Image optimization
- Code splitting automÃ¡tico

### Backend Performance
- Database query optimization
- Redis caching strategy
- API response compression
- Connection pooling

### Monitoring Commands
```bash
# Bundle analysis
npm run build:analyze

# Performance profiling
npm run dev -- --profile

# Database performance
EXPLAIN ANALYZE SELECT * FROM users;
```
